This is the record of the fix for MoH

Ruby console for resourcetracking.heroku.com
>>   old_org       = Organization.find 4088
=> #<Donor id: 4088, name: "MINISTRY HEATH", type: "Donor", created_at: "2010-09-07 06:20:39", updated_at: "2010-09-07 06:20:39", raw_type: nil>
>> old_org.activities.each { |a| puts "  Updating activity #{a.id} by Org: #{a.organization}" }
  Updating activity 1872 by Org: Imbuto Foundation/PACFA
=> [#<Activity id: 1872, name: "Technical and Financial support to ", beneficiary: nil, target: nil, created_at: "2010-09-10 11:46:14", updated_at: "2010-09-10 11:46:14", provider_id: nil, other_cost_type_id: nil, description: "In partnership with MoH and IntraHealth, provide a ...", type: nil, budget: #<BigDecimal:2aaacc01f328,'0.25E7',9(18)>, spend_q1: #<BigDecimal:2aaacc01f288,'0.0',9(18)>, spend_q2: #<BigDecimal:2aaacc01f1e8,'0.0',9(18)>, spend_q3: #<BigDecimal:2aaacc01ee28,'0.0',9(18)>, spend_q4: #<BigDecimal:2aaacc01ea40,'0.0',9(18)>, start: "2010-07-10", end: "2010-12-31", spend: #<BigDecimal:2aaacc018078,'0.0',9(18)>, text_for_provider: nil, text_for_targets: nil, text_for_beneficiaries: nil, spend_q4_prev: #<BigDecimal:2aaacc017ba0,'0.0',9(18)>, data_response_id: 6547, activity_id: 1872, budget_percentage: nil, spend_percentage: nil, approved: nil>]
>> old_org.activities.each { |a| a.organizations.delete(old_org); a.organizations.push(new_org) }
NameError: undefined local variable or method `new_org' for #<Object:0x2aaac25fa298 @heroku_console_output=[]>
>> FundingFlow.find_all_by_organization_id_from(old_org.id).each { |fflow| puts "  Updating fflow #{fflow.id} by Org: #{fflow.data_response.responding_organization}" }

  Updating fflow 1278 by Org: BUTARE CHU National Hospital | Huye
=> [#<FundingFlow id: 1278, organization_id_from: 4088, organization_id_to: 3160, project_id: 401, created_at: "2010-09-22 13:55:01", updated_at: "2010-09-22 13:55:01", budget: #<BigDecimal:2aaacc436a60,'0.6048E9',9(27)>, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 0, spend: nil, spend_q4_prev: nil, data_response_id: 6009>]
>>
>> FundingFlow.find_all_by_organization_id_from(old_org.id).each { |fflow| fflow.organization_id_from = new_org.id; fflow.save! }

NameError: undefined local variable or method `new_org' for #<Object:0x2aaac25fa298 @heroku_console_output=[]>
>>
>> FundingFlow.find_all_by_organization_id_to(old_org.id).each { |fflow| puts "  Updating fflow #{fflow.id} by Org: #{fflow.data_response.responding_organization}" }
=> []
>>     old_org.activities.each { |a| puts "  Updating activity #{a.id} by Org: #{a.organization}" }

  Updating activity 1872 by Org: Imbuto Foundation/PACFA
=> [#<Activity id: 1872, name: "Technical and Financial support to ", beneficiary: nil, target: nil, created_at: "2010-09-10 11:46:14", updated_at: "2010-09-10 11:46:14", provider_id: nil, other_cost_type_id: nil, description: "In partnership with MoH and IntraHealth, provide a ...", type: nil, budget: #<BigDecimal:2aaacc16cc58,'0.25E7',9(18)>, spend_q1: #<BigDecimal:2aaacc16cb68,'0.0',9(18)>, spend_q2: #<BigDecimal:2aaacc16ca78,'0.0',9(18)>, spend_q3: #<BigDecimal:2aaacc16c9d8,'0.0',9(18)>, spend_q4: #<BigDecimal:2aaacc16c8c0,'0.0',9(18)>, start: "2010-07-10", end: "2010-12-31", spend: #<BigDecimal:2aaacc167ed8,'0.0',9(18)>, text_for_provider: nil, text_for_targets: nil, text_for_beneficiaries: nil, spend_q4_prev: #<BigDecimal:2aaacc1679b0,'0.0',9(18)>, data_response_id: 6547, activity_id: 1872, budget_percentage: nil, spend_percentage: nil, approved: nil>]
>>
>> old_org.activities.each { |a| a.organizations.delete(old_org); a.organizations.push(Organization.find(3954)
) }
SyntaxError: compile error
/home/heroku_rack/lib/console.rb:145: syntax error, unexpected $end, expecting ')'
...s.push(Organization.find(3954)
                              ^
>> ) }
SyntaxError: compile error
/home/heroku_rack/lib/console.rb:145: syntax error, unexpected ')'
>> FundingFlow.find_all_by_organization_id_from(old_org.id).each { |fflow| puts "  Updating fflow #{fflow.id} by Org: #{fflow.data_response.responding_organization}" }

en  Updating fflow 1278 by Org: BUTARE CHU National Hospital | Huye
=> [#<FundingFlow id: 1278, organization_id_from: 4088, organization_id_to: 3160, project_id: 401, created_at: "2010-09-22 13:55:01", updated_at: "2010-09-22 13:55:01", budget: #<BigDecimal:2aaacc3f6550,'0.6048E9',9(27)>, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 0, spend: nil, spend_q4_prev: nil, data_response_id: 6009>]
>>
>> end
SyntaxError: compile error
/home/heroku_rack/lib/console.rb:145: syntax error, unexpected kEND
>> old_org       = Organization.find 4088
=> #<Donor id: 4088, name: "MINISTRY HEATH", type: "Donor", created_at: "2010-09-07 06:20:39", updated_at: "2010-09-07 06:20:39", raw_type: nil>
>>   puts "Found #{old_org.activities.count} activities"
Found 0 activities
=> nil
>> old_org.activities.each { |a| puts "  Updating activity #{a.id} by Org: #{a.organization}" }
=> []
>> a = Activity.find 1872
=> #<Activity id: 1872, name: "Technical and Financial support to ", beneficiary: nil, target: nil, created_at: "2010-09-10 11:46:14", updated_at: "2010-09-10 11:46:14", provider_id: nil, other_cost_type_id: nil, description: "In partnership with MoH and IntraHealth, provide a ...", type: nil, budget: #<BigDecimal:2aaacc319510,'0.25E7',9(18)>, spend_q1: #<BigDecimal:2aaacc319380,'0.0',9(18)>, spend_q2: #<BigDecimal:2aaacc3191c8,'0.0',9(18)>, spend_q3: #<BigDecimal:2aaacc319038,'0.0',9(18)>, spend_q4: #<BigDecimal:2aaacc318ea8,'0.0',9(18)>, start: "2010-07-10", end: "2010-12-31", spend: #<BigDecimal:2aaacc30b078,'0.0',9(18)>, text_for_provider: nil, text_for_targets: nil, text_for_beneficiaries: nil, spend_q4_prev: #<BigDecimal:2aaacc3099d0,'0.0',9(18)>, data_response_id: 6547, activity_id: nil, budget_percentage: nil, spend_percentage: nil, approved: nil>
>> Activity.find(1872).organizations.push(Organization.find(3954))
=> [#<Organization id: 3954, name: "Ministry of Health", type: nil, created_at: "2010-08-25 22:38:49", updated_at: "2010-09-22 13:58:31", raw_type: nil>]
>> FundingFlow.find_all_by_organization_id_from(old_org.id).each { |fflow| puts "  Updating fflow #{fflow.id} by Org: #{fflow.data_response.responding_organization}" }

  Updating fflow 1278 by Org: BUTARE CHU National Hospital | Huye
=> [#<FundingFlow id: 1278, organization_id_from: 4088, organization_id_to: 3160, project_id: 401, created_at: "2010-09-22 13:55:01", updated_at: "2010-09-22 13:55:01", budget: #<BigDecimal:2aaacc5605a8,'0.6048E9',9(27)>, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 0, spend: nil, spend_q4_prev: nil, data_response_id: 6009>]
>>
>> FundingFlow.find_all_by_organization_id_from(old_org.id).each { |fflow| fflow.organization_id_from = Organization.find(3954).id; fflow.save! }

=> [#<FundingFlow id: 1278, organization_id_from: 3954, organization_id_to: 3160, project_id: 401, created_at: "2010-09-22 13:55:01", updated_at: "2010-09-22 14:45:10", budget: #<BigDecimal:2aaacc5486b0,'0.6048E9',9(27)>, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 0, spend: nil, spend_q4_prev: nil, data_response_id: 6009>]
>>
>> FundingFlow.find_all_by_organization_id_to(old_org.id).each { |fflow| puts "  Updating fflow #{fflow.id} by Org: #{fflow.data_response.responding_organization}" }

=> []
>>
>> FundingFlow.find_all_by_organization_id_to(old_org.id).each { |fflow| fflow.organization_id_to = Organization.find(3954).id; fflow.save! }

=> []
>>
>> pp old_org.locations

NoMethodError: undefined method `pp' for #<Object:0x2aaac25fa298 @heroku_console_output=[]>
>>
>> old_org
=> #<Donor id: 4088, name: "MINISTRY HEATH", type: "Donor", created_at: "2010-09-07 06:20:39", updated_at: "2010-09-07 06:20:39", raw_type: nil>
>>  new_org       = Organization.find(3954)
=> #<Organization id: 3954, name: "Ministry of Health", type: nil, created_at: "2010-08-25 22:38:49", updated_at: "2010-09-22 13:58:31", raw_type: nil>
>> old_org.destroy
=> #<Donor id: 4088, name: "MINISTRY HEATH", type: "Donor", created_at: "2010-09-07 06:20:39", updated_at: "2010-09-07 06:20:39", raw_type: nil>
>> old_org       = Organization.find 4067
=> #<Organization id: 4067, name: "Ministry of Health (MOH)- Rwanda", type: nil, created_at: "2010-09-02 10:41:02", updated_at: "2010-09-02 10:41:02", raw_type: nil>
>> puts "Found #{old_org.activities.count} activities"
Found 5 activities
=> nil
>> old_org.activities.each { |a| puts "  Updating activity #{a.id} by Org: #{a.organization}" }

  Updating activity 1279 by Org: German cooperation (GTZ, KfW, DED, CIM, InWent)
  Updating activity 1750 by Org: German cooperation (GTZ, KfW, DED, CIM, InWent)
  Updating activity 1287 by Org: German cooperation (GTZ, KfW, DED, CIM, InWent)
  Updating activity 1278 by Org: German cooperation (GTZ, KfW, DED, CIM, InWent)
  Updating activity 1693 by Org: German cooperation (GTZ, KfW, DED, CIM, InWent)
=> [#<Activity id: 1279, name: nil, beneficiary: nil, target: nil, created_at: "2010-08-29 08:40:27", updated_at: "2010-09-20 14:51:22", provider_id: 4104, other_cost_type_id: nil, description: "Technical support to donor coordination of SWAP", type: nil, budget: #<BigDecimal:2aaacc621c58,'0.42E8',9(18)>, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, start: nil, end: nil, spend: #<BigDecimal:2aaacc6215f0,'0.42E8',9(18)>, text_for_provider: nil, text_for_targets: nil, text_for_beneficiaries: nil, spend_q4_prev: nil, data_response_id: 6540, activity_id: 1279, budget_percentage: nil, spend_percentage: nil, approved: nil>, #<Activity id: 1750, name: nil, beneficiary: nil, target: nil, created_at: "2010-09-02 12:01:50", updated_at: "2010-09-08 14:49:45", provider_id: 4013, other_cost_type_id: nil, description: "Support to sector budget support", type: nil, budget: #<BigDecimal:2aaacc61fac0,'0.245E10',18(27)>, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, start: nil, end: nil, spend: #<BigDecimal:2aaacc61f408,'0.42E10',18(27)>, text_for_provider: nil, text_for_targets: nil, text_for_beneficiaries: nil, spend_q4_prev: nil, data_response_id: 6540, activity_id: 1750, budget_percentage: nil, spend_percentage: nil, approved: nil>, #<Activity id: 1287, name: nil, beneficiary: nil, target: nil, created_at: "2010-08-29 08:40:28", updated_at: "2010-09-21 07:08:19", provider_id: 4104, other_cost_type_id: nil, description: "Support to the family plannin, mather safehood acti...", type: nil, budget: #<BigDecimal:2aaacc61da40,'0.211558E8',9(18)>, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, start: "2009-01-01", end: "2012-12-01", spend: #<BigDecimal:2aaacc615610,'0.1416175E8',9(18)>, text_for_provider: nil, text_for_targets: nil, text_for_beneficiaries: nil, spend_q4_prev: nil, data_response_id: 6540, activity_id: 1287, budget_percentage: nil, spend_percentage: nil, approved: nil>, #<Activity id: 1278, name: nil, beneficiary: nil, target: nil, created_at: "2010-08-29 08:40:27", updated_at: "2010-09-20 14:51:59", provider_id: 4104, other_cost_type_id: nil, description: "Co-financing of the Capacity Development Pooled Fun...", type: nil, budget: #<BigDecimal:2aaacc613568,'0.21E9',9(27)>, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, start: "2010-01-01", end: "2011-12-01", spend: #<BigDecimal:2aaacc60b2f0,'0.148E9',9(27)>, text_for_provider: nil, text_for_targets: nil, text_for_beneficiaries: nil, spend_q4_prev: nil, data_response_id: 6540, activity_id: 1278, budget_percentage: nil, spend_percentage: nil, approved: nil>, #<Activity id: 1693, name: nil, beneficiary: nil, target: nil, created_at: "2010-09-01 13:42:39", updated_at: "2010-09-01 13:42:58", provider_id: 4013, other_cost_type_id: nil, description: "Co-financing of the Capacity Development Pooled Fun...", type: nil, budget: #<BigDecimal:2aaacc6094c8,'0.7E8',9(18)>, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, start: "2010-07-01", end: "2012-12-01", spend: nil, text_for_provider: nil, text_for_targets: nil, text_for_beneficiaries: nil, spend_q4_prev: nil, data_response_id: 6540, activity_id: 1693, budget_percentage: nil, spend_percentage: nil, approved: nil>]
>>
>> old_org.activities.each { |a| a.organizations.delete(old_org); a.organizations.push(Organization.find(3954)) }

=> [#<Activity id: 1279, name: nil, beneficiary: nil, target: nil, created_at: "2010-08-29 08:40:27", updated_at: "2010-09-20 14:51:22", provider_id: 4104, other_cost_type_id: nil, description: "Technical support to donor coordination of SWAP", type: nil, budget: #<BigDecimal:2aaacc5adc18,'0.42E8',9(18)>, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, start: nil, end: nil, spend: #<BigDecimal:2aaacc5ad998,'0.42E8',9(18)>, text_for_provider: nil, text_for_targets: nil, text_for_beneficiaries: nil, spend_q4_prev: nil, data_response_id: 6540, activity_id: 1279, budget_percentage: nil, spend_percentage: nil, approved: nil>, #<Activity id: 1750, name: nil, beneficiary: nil, target: nil, created_at: "2010-09-02 12:01:50", updated_at: "2010-09-08 14:49:45", provider_id: 4013, other_cost_type_id: nil, description: "Support to sector budget support", type: nil, budget: #<BigDecimal:2aaacc5aca20,'0.245E10',18(27)>, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, start: nil, end: nil, spend: #<BigDecimal:2aaacc5ac6b0,'0.42E10',18(27)>, text_for_provider: nil, text_for_targets: nil, text_for_beneficiaries: nil, spend_q4_prev: nil, data_response_id: 6540, activity_id: 1750, budget_percentage: nil, spend_percentage: nil, approved: nil>, #<Activity id: 1287, name: nil, beneficiary: nil, target: nil, created_at: "2010-08-29 08:40:28", updated_at: "2010-09-21 07:08:19", provider_id: 4104, other_cost_type_id: nil, description: "Support to the family plannin, mather safehood acti...", type: nil, budget: #<BigDecimal:2aaacc5ab968,'0.211558E8',9(18)>, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, start: "2009-01-01", end: "2012-12-01", spend: #<BigDecimal:2aaacc5a2890,'0.1416175E8',9(18)>, text_for_provider: nil, text_for_targets: nil, text_for_beneficiaries: nil, spend_q4_prev: nil, data_response_id: 6540, activity_id: 1287, budget_percentage: nil, spend_percentage: nil, approved: nil>, #<Activity id: 1278, name: nil, beneficiary: nil, target: nil, created_at: "2010-08-29 08:40:27", updated_at: "2010-09-20 14:51:59", provider_id: 4104, other_cost_type_id: nil, description: "Co-financing of the Capacity Development Pooled Fun...", type: nil, budget: #<BigDecimal:2aaacc5a0fe0,'0.21E9',9(27)>, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, start: "2010-01-01", end: "2011-12-01", spend: #<BigDecimal:2aaacc59a820,'0.148E9',9(27)>, text_for_provider: nil, text_for_targets: nil, text_for_beneficiaries: nil, spend_q4_prev: nil, data_response_id: 6540, activity_id: 1278, budget_percentage: nil, spend_percentage: nil, approved: nil>, #<Activity id: 1693, name: nil, beneficiary: nil, target: nil, created_at: "2010-09-01 13:42:39", updated_at: "2010-09-01 13:42:58", provider_id: 4013, other_cost_type_id: nil, description: "Co-financing of the Capacity Development Pooled Fun...", type: nil, budget: #<BigDecimal:2aaacc599448,'0.7E8',9(18)>, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, start: "2010-07-01", end: "2012-12-01", spend: nil, text_for_provider: nil, text_for_targets: nil, text_for_beneficiaries: nil, spend_q4_prev: nil, data_response_id: 6540, activity_id: 1693, budget_percentage: nil, spend_percentage: nil, approved: nil>]
>>
>> FundingFlow.find_all_by_organization_id_from(old_org.id).each { |fflow| puts "  Updating fflow #{fflow.id} by Org: #{fflow.data_response.responding_organization}" }
=> []
>>     FundingFlow.find_all_by_organization_id_from(old_org.id).each { |fflow| fflow.organization_id_from = Organization.find(3954).id; fflow.save! }

=> []
>>
>>     FundingFlow.find_all_by_organization_id_to(old_org.id).each { |fflow| puts "  Updating fflow #{fflow.id} by Org: #{fflow.data_response.responding_organization}" }

  Updating fflow 887 by Org: ICAP
=> [#<FundingFlow id: 887, organization_id_from: 3695, organization_id_to: 4067, project_id: nil, created_at: "2010-09-02 10:40:00", updated_at: "2010-09-02 10:41:02", budget: nil, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 0, spend: nil, spend_q4_prev: nil, data_response_id: 6544>]
>>
>>     FundingFlow.find_all_by_organization_id_to(old_org.id).each { |fflow| fflow.organization_id_to = Organization.find(3954).id; fflow.save! }

=> [#<FundingFlow id: 887, organization_id_from: 3695, organization_id_to: 3954, project_id: nil, created_at: "2010-09-02 10:40:00", updated_at: "2010-09-22 14:46:56", budget: nil, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 0, spend: nil, spend_q4_prev: nil, data_response_id: 6544>]
>>
>>     pp old_org.locations

NoMethodError: undefined method `pp' for #<Object:0x2aaac25fa298 @heroku_console_output=[]>
>>
>> old_org.users
=> []
>>     old_org.destroy

=> #<Organization id: 4067, name: "Ministry of Health (MOH)- Rwanda", type: nil, created_at: "2010-09-02 10:41:02", updated_at: "2010-09-02 10:41:02", raw_type: nil>
>>
>>   old_org       = Organization.find 4008
=> #<Organization id: 4008, name: "Ministry of Health", type: nil, created_at: "2010-08-31 12:41:14", updated_at: "2010-08-31 12:41:14", raw_type: nil>
>>     DataResponse.find_by_organization_id_responder 4008

=> nil
>>
>>     puts "Found #{old_org.activities.count} activities"

Found 1 activities
=> nil
>>
>>     old_org.users.each { |u| puts "moving user #{u.email}..." }
moving user jlou.mukunzi@gmail.com...
moving user nzizera@gmail.com...
=> [#<User id: 2196, username: "mukunzi", email: "jlou.mukunzi@gmail.com", crypted_password: "9eba4539848e12f580c11d451c993325ad72b8d57252258a66b...", password_salt: "1iGlEBgnIOFxGxrCYNI4", persistence_token: "51f70f4607614933465416d8fa10791fabf17adc4ad3095e6d6...", created_at: "2010-09-08 12:08:01", updated_at: "2010-09-21 10:38:07", roles_mask: 1, organization_id: 4008, data_response_id_current: nil, text_for_organization: nil, full_name: nil>, #<User id: 2258, username: "nzizera@gmail.com", email: "nzizera@gmail.com", crypted_password: "709e2f0cc1bb71d1851d6165cc22c37bcd306c8c544cd6f771b...", password_salt: "pm47d69X3LYHAidcRKiU", persistence_token: "3a033fbd36b78e1c87a933a6685d38522530eef895d55866138...", created_at: "2010-09-22 07:26:25", updated_at: "2010-09-22 07:26:25", roles_mask: 2, organization_id: 4008, data_response_id_current: nil, text_for_organization: nil, full_name: nil>]
>>     old_org.users.each { |u| u.organization = Organization.find(3954); u.data_response_id_current = Organization.find(3954).data_responses.first.id; u.save! }

=> [#<User id: 2196, username: "mukunzi", email: "jlou.mukunzi@gmail.com", crypted_password: "9eba4539848e12f580c11d451c993325ad72b8d57252258a66b...", password_salt: "1iGlEBgnIOFxGxrCYNI4", persistence_token: "51f70f4607614933465416d8fa10791fabf17adc4ad3095e6d6...", created_at: "2010-09-08 12:08:01", updated_at: "2010-09-22 14:47:30", roles_mask: 1, organization_id: 3954, data_response_id_current: 6658, text_for_organization: nil, full_name: nil>, #<User id: 2258, username: "nzizera@gmail.com", email: "nzizera@gmail.com", crypted_password: "709e2f0cc1bb71d1851d6165cc22c37bcd306c8c544cd6f771b...", password_salt: "pm47d69X3LYHAidcRKiU", persistence_token: "3a033fbd36b78e1c87a933a6685d38522530eef895d55866138...", created_at: "2010-09-22 07:26:25", updated_at: "2010-09-22 14:47:30", roles_mask: 2, organization_id: 3954, data_response_id_current: 6658, text_for_organization: nil, full_name: nil>]
>>
>> new_org.reload
new_org.users=> #<Organization id: 3954, name: "Ministry of Health", type: nil, created_at: "2010-08-25 22:38:49", updated_at: "2010-09-22 13:58:31", raw_type: nil>
>> new_org.users
=> [#<User id: 2196, username: "mukunzi", email: "jlou.mukunzi@gmail.com", crypted_password: "9eba4539848e12f580c11d451c993325ad72b8d57252258a66b...", password_salt: "1iGlEBgnIOFxGxrCYNI4", persistence_token: "51f70f4607614933465416d8fa10791fabf17adc4ad3095e6d6...", created_at: "2010-09-08 12:08:01", updated_at: "2010-09-22 14:47:30", roles_mask: 1, organization_id: 3954, data_response_id_current: 6658, text_for_organization: nil, full_name: nil>, #<User id: 2225, username: "Ithiel", email: "mukwesij@yahoo.fr", crypted_password: "7dc6a2d4ac4af0dfde9da27c2308a0be9f5e5588debe92fad54...", password_salt: "nbJpvLEuGIrYONmXdR7N", persistence_token: "481538444dc3d65484703f91a2b3d02f4807d76c9f1c98dfc43...", created_at: "2010-09-21 08:51:10", updated_at: "2010-09-21 12:31:53", roles_mask: 2, organization_id: 3954, data_response_id_current: 6658, text_for_organization: nil, full_name: nil>, #<User id: 2246, username: "mbajean@yahoo.fr", email: "mbajean@yahoo.fr", crypted_password: "29cbe81e567b09d46ddd10d4b5aa1d3b5fa1b95686ab2bbf5f0...", password_salt: "3m3HWhWNAOpLDJpEMT9P", persistence_token: "409e66828f2cb234a87a59a7498f154ca632720a2650dc574d5...", created_at: "2010-09-21 12:29:03", updated_at: "2010-09-21 12:30:10", roles_mask: 2, organization_id: 3954, data_response_id_current: 6658, text_for_organization: nil, full_name: nil>, #<User id: 2250, username: "bajyadona@gmail.com", email: "bajyadona@gmail.com", crypted_password: "1e97c344c1efb2f59518b5c5977457054e719ad60e56c3eeee3...", password_salt: "BHdBvExUzj9j8y8BAshq", persistence_token: "f11bb4f45ef6b2f7a3da7fbb9ffe78e9701cc5e7742c607b9d0...", created_at: "2010-09-21 12:50:28", updated_at: "2010-09-21 12:52:41", roles_mask: 2, organization_id: 3954, data_response_id_current: 6658, text_for_organization: nil, full_name: nil>, #<User id: 2251, username: "maniraguharuth@yahoo.fr", email: "maniraguharuth@yahoo.fr", crypted_password: "877d823ff728f901a62128e851b7afef0c0205e4fe720dd4842...", password_salt: "MpBV5GHeNzQdYbd0YJV", persistence_token: "c591f64eb5b0329a00734ce9800a05a4078014e8c0e0e6c5ab0...", created_at: "2010-09-21 12:55:29", updated_at: "2010-09-21 12:56:10", roles_mask: 2, organization_id: 3954, data_response_id_current: 6658, text_for_organization: nil, full_name: nil>, #<User id: 2253, username: "mat_mic2001@yahoo.fr", email: "mat_mic2001@yahoo.fr", crypted_password: "d2da77a3ae93eacf624d39d9546704e6ca79058ff651cfeb3a9...", password_salt: "oIgN8QIcn3euTKcxlIP", persistence_token: "1efd35cf5189e8144db3b18cec88e5df6d43cb8e547270a8919...", created_at: "2010-09-21 13:26:54", updated_at: "2010-09-21 13:27:55", roles_mask: 2, organization_id: 3954, data_response_id_current: 6658, text_for_organization: nil, full_name: nil>, #<User id: 2254, username: "fidele.karangwa@gmail.com", email: "fidele.karangwa@gmail.com", crypted_password: "f60a582cd20c0d13a66ec71aaf523c8ef643490584c299b3294...", password_salt: "MKD1nnit27D9IDHRUzs1", persistence_token: "7d1e622a939f4ad1dc6d878d31e5ce91e81661f6bce6fd40385...", created_at: "2010-09-21 13:51:23", updated_at: "2010-09-21 13:54:00", roles_mask: 2, organization_id: 3954, data_response_id_current: 6658, text_for_organization: nil, full_name: nil>, #<User id: 2258, username: "nzizera@gmail.com", email: "nzizera@gmail.com", crypted_password: "709e2f0cc1bb71d1851d6165cc22c37bcd306c8c544cd6f771b...", password_salt: "pm47d69X3LYHAidcRKiU", persistence_token: "3a033fbd36b78e1c87a933a6685d38522530eef895d55866138...", created_at: "2010-09-22 07:26:25", updated_at: "2010-09-22 14:47:30", roles_mask: 2, organization_id: 3954, data_response_id_current: 6658, text_for_organization: nil, full_name: nil>, #<User id: 2247, username: "claudinion@gmail.com", email: "claudinion@gmail.com", crypted_password: "35ea367546f07bb07f48a46c7e0770be731e101e3df03d5a091...", password_salt: "HVmm01SUmgRExOUH8FMJ", persistence_token: "b801153d9211dac7f272002dc372cada7a41fcc15c5b052bbb1...", created_at: "2010-09-21 12:33:05", updated_at: "2010-09-22 07:09:54", roles_mask: 2, organization_id: 3954, data_response_id_current: 6658, text_for_organization: nil, full_name: nil>, #<User id: 2249, username: "watuma2001@yahoo.fr", email: "watuma2001@yahoo.fr", crypted_password: "4e119980ec32e8459a4ec1341ae32476a7405039a864782cbe3...", password_salt: "CiCSp77WL5DSmVtfbzO", persistence_token: "11e02563574752361220ef961db45c654cd3d7d2f47585cc460...", created_at: "2010-09-21 12:37:32", updated_at: "2010-09-22 12:26:07", roles_mask: 2, organization_id: 3954, data_response_id_current: 6658, text_for_organization: nil, full_name: nil>]
>> old_org.destroy
=> #<Organization id: 4008, name: "Ministry of Health", type: nil, created_at: "2010-08-31 12:41:14", updated_at: "2010-08-31 12:41:14", raw_type: nil>
>> old_org       = Organization.find 3896
=> #<Donor id: 3896, name: "Ministry of Health", type: "Donor", created_at: "2010-08-06 09:27:01", updated_at: "2010-09-22 07:52:04", raw_type: nil>
>> puts "Found #{old_org.activities.count} activities"
Found 2 activities
=> nil
>> old_org.activities.each { |a| puts "  Updating activity #{a.id} by Org: #{a.organization}" }

  Updating activity 909 by Org: Tulane University
  Updating activity 911 by Org: Tulane University
=> [#<Activity id: 909, name: nil, beneficiary: nil, target: nil, created_at: "2010-08-19 08:07:05", updated_at: "2010-09-20 07:18:06", provider_id: 3906, other_cost_type_id: nil, description: nil, type: nil, budget: #<BigDecimal:2aaacc382fb0,'0.468019E6',9(18)>, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, start: "2008-10-01", end: "2011-09-29", spend: #<BigDecimal:2aaacc37dc68,'0.427339E6',9(18)>, text_for_provider: nil, text_for_targets: nil, text_for_beneficiaries: nil, spend_q4_prev: nil, data_response_id: 6573, activity_id: 909, budget_percentage: nil, spend_percentage: nil, approved: nil>, #<Activity id: 911, name: nil, beneficiary: nil, target: nil, created_at: "2010-08-19 08:12:50", updated_at: "2010-09-20 07:18:57", provider_id: 3724, other_cost_type_id: nil, description: nil, type: nil, budget: #<BigDecimal:2aaacc37cbd8,'0.2434373E7',9(18)>, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, start: "2008-09-30", end: "2013-09-29", spend: #<BigDecimal:2aaacc3783d0,'0.1659947E7',9(18)>, text_for_provider: nil, text_for_targets: nil, text_for_beneficiaries: nil, spend_q4_prev: nil, data_response_id: 6573, activity_id: 911, budget_percentage: nil, spend_percentage: nil, approved: nil>]
>>
>> old_org.activities.each { |a| a.organizations.delete(old_org); a.organizations.push(Organization.find(3954)) }

=> [#<Activity id: 909, name: nil, beneficiary: nil, target: nil, created_at: "2010-08-19 08:07:05", updated_at: "2010-09-20 07:18:06", provider_id: 3906, other_cost_type_id: nil, description: nil, type: nil, budget: #<BigDecimal:2aaacc34b9e8,'0.468019E6',9(18)>, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, start: "2008-10-01", end: "2011-09-29", spend: #<BigDecimal:2aaacc334270,'0.427339E6',9(18)>, text_for_provider: nil, text_for_targets: nil, text_for_beneficiaries: nil, spend_q4_prev: nil, data_response_id: 6573, activity_id: 909, budget_percentage: nil, spend_percentage: nil, approved: nil>, #<Activity id: 911, name: nil, beneficiary: nil, target: nil, created_at: "2010-08-19 08:12:50", updated_at: "2010-09-20 07:18:57", provider_id: 3724, other_cost_type_id: nil, description: nil, type: nil, budget: #<BigDecimal:2aaacc331200,'0.2434373E7',9(18)>, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, start: "2008-09-30", end: "2013-09-29", spend: #<BigDecimal:2aaacc326b48,'0.1659947E7',9(18)>, text_for_provider: nil, text_for_targets: nil, text_for_beneficiaries: nil, spend_q4_prev: nil, data_response_id: 6573, activity_id: 911, budget_percentage: nil, spend_percentage: nil, approved: nil>]
>>
>> FundingFlow.find_all_by_organization_id_from(old_org.id).each { |fflow| puts "  Updating fflow #{fflow.id} by Org: #{fflow.data_response.responding_organization}" }

  Updating fflow 1159 by Org: Ministry of Health
  Updating fflow 1166 by Org: ACM - Atelier Central de Maintenance  / Central Maintenance Workshop
=> [#<FundingFlow id: 1159, organization_id_from: 3896, organization_id_to: 3896, project_id: 359, created_at: "2010-09-22 07:52:04", updated_at: "2010-09-22 07:52:04", budget: #<BigDecimal:2aaacc58c8b0,'0.4187660701E10',18(27)>, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 1, spend: nil, spend_q4_prev: nil, data_response_id: 6600>, #<FundingFlow id: 1166, organization_id_from: 3896, organization_id_to: 3042, project_id: 290, created_at: "2010-09-22 08:04:45", updated_at: "2010-09-22 08:04:45", budget: nil, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 0, spend: #<BigDecimal:2aaacc5896b0,'0.1320378E7',9(18)>, spend_q4_prev: nil, data_response_id: 5891>]
>>
>> FundingFlow.find_all_by_organization_id_from(old_org.id).each { |fflow| fflow.organization_id_from = Organization.find(3954).id; fflow.save! }

=> [#<FundingFlow id: 1159, organization_id_from: 3954, organization_id_to: 3896, project_id: 359, created_at: "2010-09-22 07:52:04", updated_at: "2010-09-22 14:48:33", budget: #<BigDecimal:2aaacc55b0f8,'0.4187660701E10',18(27)>, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 1, spend: nil, spend_q4_prev: nil, data_response_id: 6600>, #<FundingFlow id: 1166, organization_id_from: 3954, organization_id_to: 3042, project_id: 290, created_at: "2010-09-22 08:04:45", updated_at: "2010-09-22 14:48:33", budget: nil, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 0, spend: #<BigDecimal:2aaacc55a4c8,'0.1320378E7',9(18)>, spend_q4_prev: nil, data_response_id: 5891>]
>>
>> FundingFlow.find_all_by_organization_id_to(old_org.id).each { |fflow| puts "  Updating fflow #{fflow.id} by Org: #{fflow.data_response.responding_organization}" }

  Updating fflow 1001 by Org: Clinton Health Access Initiative (CHAI)
  Updating fflow 1159 by Org: Ministry of Health
  Updating fflow 1158 by Org: Ministry of Health
=> [#<FundingFlow id: 1001, organization_id_from: 3678, organization_id_to: 3896, project_id: 284, created_at: "2010-09-10 12:31:51", updated_at: "2010-09-14 12:27:16", budget: #<BigDecimal:2aaacc52dd38,'0.180332E6',9(18)>, spend_q1: #<BigDecimal:2aaacc52dba8,'0.0',9(18)>, spend_q2: #<BigDecimal:2aaacc52dae0,'0.0',9(18)>, spend_q3: #<BigDecimal:2aaacc52da40,'0.0',9(18)>, spend_q4: #<BigDecimal:2aaacc52d9a0,'0.0',9(18)>, organization_text: nil, self_provider_flag: 1, spend: #<BigDecimal:2aaacc52d838,'0.0',9(18)>, spend_q4_prev: nil, data_response_id: 6527>, #<FundingFlow id: 1159, organization_id_from: 3954, organization_id_to: 3896, project_id: 359, created_at: "2010-09-22 07:52:04", updated_at: "2010-09-22 14:48:33", budget: #<BigDecimal:2aaacc52cf00,'0.4187660701E10',18(27)>, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 1, spend: nil, spend_q4_prev: nil, data_response_id: 6600>, #<FundingFlow id: 1158, organization_id_from: nil, organization_id_to: 3896, project_id: 359, created_at: "2010-09-22 07:52:04", updated_at: "2010-09-22 07:52:04", budget: #<BigDecimal:2aaacc52bdf8,'0.4187660701E10',18(27)>, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 0, spend: nil, spend_q4_prev: nil, data_response_id: 6600>]
>>
>> FundingFlow.find_all_by_organization_id_to(old_org.id).each { |fflow| fflow.organization_id_to = Organization.find(3954).id; fflow.save! }

=> [#<FundingFlow id: 1001, organization_id_from: 3678, organization_id_to: 3954, project_id: 284, created_at: "2010-09-10 12:31:51", updated_at: "2010-09-22 14:48:42", budget: #<BigDecimal:2aaacc4d5cc8,'0.180332E6',9(18)>, spend_q1: #<BigDecimal:2aaacc4d5c28,'0.0',9(18)>, spend_q2: #<BigDecimal:2aaacc4d5b60,'0.0',9(18)>, spend_q3: #<BigDecimal:2aaacc4d5a70,'0.0',9(18)>, spend_q4: #<BigDecimal:2aaacc4d59a8,'0.0',9(18)>, organization_text: nil, self_provider_flag: 1, spend: #<BigDecimal:2aaacc4d52c8,'0.0',9(18)>, spend_q4_prev: nil, data_response_id: 6527>, #<FundingFlow id: 1159, organization_id_from: 3954, organization_id_to: 3954, project_id: 359, created_at: "2010-09-22 07:52:04", updated_at: "2010-09-22 14:48:42", budget: #<BigDecimal:2aaacc4d4670,'0.4187660701E10',18(27)>, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 1, spend: nil, spend_q4_prev: nil, data_response_id: 6600>, #<FundingFlow id: 1158, organization_id_from: nil, organization_id_to: 3954, project_id: 359, created_at: "2010-09-22 07:52:04", updated_at: "2010-09-22 14:48:42", budget: #<BigDecimal:2aaacc4d3590,'0.4187660701E10',18(27)>, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 0, spend: nil, spend_q4_prev: nil, data_response_id: 6600>]
>>
>> pp old_org.locations

NoMethodError: undefined method `pp' for #<Object:0x2aaac25fa298 @heroku_console_output=[]>
>>
>> old_org.users.each { |u| puts "moving user #{u.email}..." }
moving user gemma.williams3@gmail.com...
moving user regis.hitimana@moh.gov.rw...
moving user kayirangwae@rw.cdc.gov...
moving user kayigery@yahoo.fr...
=> [#<User id: 2096, username: "gemma.williams3@gmail.com", email: "gemma.williams3@gmail.com", crypted_password: "e8397c079d74ecb0584229ee73dd00a507ebae7f82966133d08...", password_salt: "wfDdcHm3--pkg47_4Ots", persistence_token: "4ba5848d839bcc1cbd1a2451b6753d2115f1b9f95b054bed8e8...", created_at: "2010-08-13 09:45:04", updated_at: "2010-08-13 09:45:04", roles_mask: 1, organization_id: 3896, data_response_id_current: nil, text_for_organization: nil, full_name: nil>, #<User id: 2091, username: "regis.hitimana@moh.gov.rw", email: "regis.hitimana@moh.gov.rw", crypted_password: "6661417b34e9270548fe428d031a7a06027541ef3e4ecac79c2...", password_salt: "fustha9gICSPQiiNZ1", persistence_token: "f4d27d0f449795157215c064d4c5ffcaa20659c0de9b6e08dfc...", created_at: "2010-08-13 08:55:07", updated_at: "2010-09-02 12:12:18", roles_mask: 1, organization_id: 3896, data_response_id_current: nil, text_for_organization: nil, full_name: nil>, #<User id: 2152, username: "kayirangwae", email: "kayirangwae@rw.cdc.gov", crypted_password: "dc083874acc6fda4c7ba243b87a0e9380f4d5fd967e59fefe23...", password_salt: "DU6ybVf2QIB3oN9Fot8N", persistence_token: "a1e8bd936d7e87a3c20265a2f57305a16d6bc6f035df3d06d47...", created_at: "2010-09-06 14:53:29", updated_at: "2010-09-06 14:53:29", roles_mask: 4, organization_id: 3896, data_response_id_current: 6600, text_for_organization: nil, full_name: "Eugenie Kayirangwa">, #<User id: 2232, username: "kayigery@yahoo.fr", email: "kayigery@yahoo.fr", crypted_password: "1932315b80cb41788f0c7eecccd16d1887608070334acec4432...", password_salt: "9Wf9KL0M9Uxt3sUVZ6Gc", persistence_token: "5907de6576eb175dd0f527bc997513923b3b03ec2f24436de0a...", created_at: "2010-09-21 09:02:00", updated_at: "2010-09-21 12:32:04", roles_mask: 2, organization_id: 3896, data_response_id_current: 6600, text_for_organization: nil, full_name: nil>]
>>
>> old_org.locations
=> []
>> old_org.users.each { |u| puts "moving user #{u.email}..." }

moving user gemma.williams3@gmail.com...
moving user regis.hitimana@moh.gov.rw...
moving user kayirangwae@rw.cdc.gov...
moving user kayigery@yahoo.fr...
=> [#<User id: 2096, username: "gemma.williams3@gmail.com", email: "gemma.williams3@gmail.com", crypted_password: "e8397c079d74ecb0584229ee73dd00a507ebae7f82966133d08...", password_salt: "wfDdcHm3--pkg47_4Ots", persistence_token: "4ba5848d839bcc1cbd1a2451b6753d2115f1b9f95b054bed8e8...", created_at: "2010-08-13 09:45:04", updated_at: "2010-08-13 09:45:04", roles_mask: 1, organization_id: 3896, data_response_id_current: nil, text_for_organization: nil, full_name: nil>, #<User id: 2091, username: "regis.hitimana@moh.gov.rw", email: "regis.hitimana@moh.gov.rw", crypted_password: "6661417b34e9270548fe428d031a7a06027541ef3e4ecac79c2...", password_salt: "fustha9gICSPQiiNZ1", persistence_token: "f4d27d0f449795157215c064d4c5ffcaa20659c0de9b6e08dfc...", created_at: "2010-08-13 08:55:07", updated_at: "2010-09-02 12:12:18", roles_mask: 1, organization_id: 3896, data_response_id_current: nil, text_for_organization: nil, full_name: nil>, #<User id: 2152, username: "kayirangwae", email: "kayirangwae@rw.cdc.gov", crypted_password: "dc083874acc6fda4c7ba243b87a0e9380f4d5fd967e59fefe23...", password_salt: "DU6ybVf2QIB3oN9Fot8N", persistence_token: "a1e8bd936d7e87a3c20265a2f57305a16d6bc6f035df3d06d47...", created_at: "2010-09-06 14:53:29", updated_at: "2010-09-06 14:53:29", roles_mask: 4, organization_id: 3896, data_response_id_current: 6600, text_for_organization: nil, full_name: "Eugenie Kayirangwa">, #<User id: 2232, username: "kayigery@yahoo.fr", email: "kayigery@yahoo.fr", crypted_password: "1932315b80cb41788f0c7eecccd16d1887608070334acec4432...", password_salt: "9Wf9KL0M9Uxt3sUVZ6Gc", persistence_token: "5907de6576eb175dd0f527bc997513923b3b03ec2f24436de0a...", created_at: "2010-09-21 09:02:00", updated_at: "2010-09-21 12:32:04", roles_mask: 2, organization_id: 3896, data_response_id_current: 6600, text_for_organization: nil, full_name: nil>]
>>
>> old_org.users.each { |u| u.organization = Organization.find(3954); u.data_response_id_current = Organization.find(3954).data_responses.first.id; u.save! }

=> [#<User id: 2096, username: "gemma.williams3@gmail.com", email: "gemma.williams3@gmail.com", crypted_password: "e8397c079d74ecb0584229ee73dd00a507ebae7f82966133d08...", password_salt: "wfDdcHm3--pkg47_4Ots", persistence_token: "4ba5848d839bcc1cbd1a2451b6753d2115f1b9f95b054bed8e8...", created_at: "2010-08-13 09:45:04", updated_at: "2010-09-22 14:49:13", roles_mask: 1, organization_id: 3954, data_response_id_current: 6658, text_for_organization: nil, full_name: nil>, #<User id: 2091, username: "regis.hitimana@moh.gov.rw", email: "regis.hitimana@moh.gov.rw", crypted_password: "6661417b34e9270548fe428d031a7a06027541ef3e4ecac79c2...", password_salt: "fustha9gICSPQiiNZ1", persistence_token: "f4d27d0f449795157215c064d4c5ffcaa20659c0de9b6e08dfc...", created_at: "2010-08-13 08:55:07", updated_at: "2010-09-22 14:49:13", roles_mask: 1, organization_id: 3954, data_response_id_current: 6658, text_for_organization: nil, full_name: nil>, #<User id: 2152, username: "kayirangwae", email: "kayirangwae@rw.cdc.gov", crypted_password: "dc083874acc6fda4c7ba243b87a0e9380f4d5fd967e59fefe23...", password_salt: "DU6ybVf2QIB3oN9Fot8N", persistence_token: "a1e8bd936d7e87a3c20265a2f57305a16d6bc6f035df3d06d47...", created_at: "2010-09-06 14:53:29", updated_at: "2010-09-22 14:49:13", roles_mask: 4, organization_id: 3954, data_response_id_current: 6658, text_for_organization: nil, full_name: "Eugenie Kayirangwa">, #<User id: 2232, username: "kayigery@yahoo.fr", email: "kayigery@yahoo.fr", crypted_password: "1932315b80cb41788f0c7eecccd16d1887608070334acec4432...", password_salt: "9Wf9KL0M9Uxt3sUVZ6Gc", persistence_token: "5907de6576eb175dd0f527bc997513923b3b03ec2f24436de0a...", created_at: "2010-09-21 09:02:00", updated_at: "2010-09-22 14:49:13", roles_mask: 2, organization_id: 3954, data_response_id_current: 6658, text_for_organization: nil, full_name: nil>]
>>
>> old_org.destroy

=> #<Donor id: 3896, name: "Ministry of Health", type: "Donor", created_at: "2010-08-06 09:27:01", updated_at: "2010-09-22 07:52:04", raw_type: nil>
>>
>> old_org       = Organization.find 3997
=> #<Organization id: 3997, name: "Ministry of Health", type: nil, created_at: "2010-08-31 11:01:20", updated_at: "2010-08-31 11:01:20", raw_type: nil>
>>     puts "Found #{old_org.activities.count} activities"

Found 2 activities
=> nil
>>
>>     old_org.activities.each { |a| puts "  Updating activity #{a.id} by Org: #{a.organization}" }

  Updating activity 1773 by Org: Concern
  Updating activity 1300 by Org: German cooperation (GTZ, KfW, DED, CIM, InWent)
=> [#<Activity id: 1773, name: nil, beneficiary: nil, target: nil, created_at: "2010-09-06 09:35:34", updated_at: "2010-09-06 09:35:34", provider_id: 3960, other_cost_type_id: nil, description: "Technical assistance to 6 districts in direct progr...", type: nil, budget: #<BigDecimal:2aaacc372c50,'0.79559E5',9(18)>, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, start: "2010-07-01", end: "2011-06-30", spend: #<BigDecimal:2aaacc36eb50,'0.79559E5',9(18)>, text_for_provider: nil, text_for_targets: nil, text_for_beneficiaries: nil, spend_q4_prev: nil, data_response_id: 6525, activity_id: 1773, budget_percentage: nil, spend_percentage: nil, approved: nil>, #<Activity id: 1300, name: nil, beneficiary: nil, target: nil, created_at: "2010-08-29 08:40:28", updated_at: "2010-09-03 07:39:47", provider_id: 4051, other_cost_type_id: nil, description: "Support the quality of hospital management and heal...", type: nil, budget: #<BigDecimal:2aaacc36dbb0,'0.9E7',9(18)>, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, start: "2009-07-01", end: "2012-12-01", spend: #<BigDecimal:2aaacc366d88,'0.146853E8',9(18)>, text_for_provider: nil, text_for_targets: nil, text_for_beneficiaries: nil, spend_q4_prev: nil, data_response_id: 6540, activity_id: 1300, budget_percentage: nil, spend_percentage: nil, approved: nil>]
>>
>>     old_org.activities.each { |a| a.organizations.delete(old_org); a.organizations.push(Organization.find(3954)) }

=> [#<Activity id: 1773, name: nil, beneficiary: nil, target: nil, created_at: "2010-09-06 09:35:34", updated_at: "2010-09-06 09:35:34", provider_id: 3960, other_cost_type_id: nil, description: "Technical assistance to 6 districts in direct progr...", type: nil, budget: #<BigDecimal:2aaacc31ec68,'0.79559E5',9(18)>, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, start: "2010-07-01", end: "2011-06-30", spend: #<BigDecimal:2aaacc314470,'0.79559E5',9(18)>, text_for_provider: nil, text_for_targets: nil, text_for_beneficiaries: nil, spend_q4_prev: nil, data_response_id: 6525, activity_id: 1773, budget_percentage: nil, spend_percentage: nil, approved: nil>, #<Activity id: 1300, name: nil, beneficiary: nil, target: nil, created_at: "2010-08-29 08:40:28", updated_at: "2010-09-03 07:39:47", provider_id: 4051, other_cost_type_id: nil, description: "Support the quality of hospital management and heal...", type: nil, budget: #<BigDecimal:2aaacc311d88,'0.9E7',9(18)>, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, start: "2009-07-01", end: "2012-12-01", spend: #<BigDecimal:2aaacc305fd8,'0.146853E8',9(18)>, text_for_provider: nil, text_for_targets: nil, text_for_beneficiaries: nil, spend_q4_prev: nil, data_response_id: 6540, activity_id: 1300, budget_percentage: nil, spend_percentage: nil, approved: nil>]
>>
>>     old_org.users.each { |u| puts "moving user #{u.email}..." }

moving user moh@moh.org...
moving user josemashav@yahoo.fr...
=> [#<User id: 2256, username: "moh", email: "moh@moh.org", crypted_password: "04c0a36d26e8d9d7b67e9fa2bcd23323d6398ab939fe6885680...", password_salt: "8WVhfhAf9yWlWLVfJM2", persistence_token: "57db72c7d4a459d8bec3eb23e790e4b58769e9446f4ff302ef6...", created_at: "2010-09-21 14:13:02", updated_at: "2010-09-21 14:13:02", roles_mask: 2, organization_id: 3997, data_response_id_current: nil, text_for_organization: nil, full_name: nil>, #<User id: 2255, username: "josemashav@yahoo.fr", email: "josemashav@yahoo.fr", crypted_password: "8e31e13eb7da6be0608f79184c008bc1911d954f852631e241c...", password_salt: "P1yUyAoPtMLqSQRhkf6f", persistence_token: "70ff5ea65f4099d6c9b6499546b3124ed43f3192c37554866f7...", created_at: "2010-09-21 14:07:34", updated_at: "2010-09-22 07:02:14", roles_mask: 2, organization_id: 3997, data_response_id_current: nil, text_for_organization: nil, full_name: nil>]
>>
>> old_org.destroy
=> #<Organization id: 3997, name: "Ministry of Health", type: nil, created_at: "2010-08-31 11:01:20", updated_at: "2010-08-31 11:01:20", raw_type: nil>
>> old_org.users
=> [#<User id: 2256, username: "moh", email: "moh@moh.org", crypted_password: "04c0a36d26e8d9d7b67e9fa2bcd23323d6398ab939fe6885680...", password_salt: "8WVhfhAf9yWlWLVfJM2", persistence_token: "57db72c7d4a459d8bec3eb23e790e4b58769e9446f4ff302ef6...", created_at: "2010-09-21 14:13:02", updated_at: "2010-09-21 14:13:02", roles_mask: 2, organization_id: 3997, data_response_id_current: nil, text_for_organization: nil, full_name: nil>, #<User id: 2255, username: "josemashav@yahoo.fr", email: "josemashav@yahoo.fr", crypted_password: "8e31e13eb7da6be0608f79184c008bc1911d954f852631e241c...", password_salt: "P1yUyAoPtMLqSQRhkf6f", persistence_token: "70ff5ea65f4099d6c9b6499546b3124ed43f3192c37554866f7...", created_at: "2010-09-21 14:07:34", updated_at: "2010-09-22 07:02:14", roles_mask: 2, organization_id: 3997, data_response_id_current: nil, text_for_organization: nil, full_name: nil>]
>> old_org.usersold_org.users.each { |u| u.organization = Organization.find(3954); u.data_response_id_current = Organization.find(3954).data_responses.first.id; u.save! }
NoMethodError: undefined method `usersold_org' for #<Organization:0x2aaacc394b20>
>> old_org.users.each { |u| u.organization = Organization.find(3954); u.data_response_id_current = Organization.find(3954).data_responses.first.id; u.save! }

=> [#<User id: 2256, username: "moh", email: "moh@moh.org", crypted_password: "04c0a36d26e8d9d7b67e9fa2bcd23323d6398ab939fe6885680...", password_salt: "8WVhfhAf9yWlWLVfJM2", persistence_token: "57db72c7d4a459d8bec3eb23e790e4b58769e9446f4ff302ef6...", created_at: "2010-09-21 14:13:02", updated_at: "2010-09-22 14:51:17", roles_mask: 2, organization_id: 3954, data_response_id_current: 6658, text_for_organization: nil, full_name: nil>, #<User id: 2255, username: "josemashav@yahoo.fr", email: "josemashav@yahoo.fr", crypted_password: "8e31e13eb7da6be0608f79184c008bc1911d954f852631e241c...", password_salt: "P1yUyAoPtMLqSQRhkf6f", persistence_token: "70ff5ea65f4099d6c9b6499546b3124ed43f3192c37554866f7...", created_at: "2010-09-21 14:07:34", updated_at: "2010-09-22 14:51:17", roles_mask: 2, organization_id: 3954, data_response_id_current: 6658, text_for_organization: nil, full_name: nil>]
>>
>> new_org.reload
new_org.users=> #<Organization id: 3954, name: "Ministry of Health", type: nil, created_at: "2010-08-25 22:38:49", updated_at: "2010-09-22 13:58:31", raw_type: nil>
>> new_org.users
=> [#<User id: 2096, username: "gemma.williams3@gmail.com", email: "gemma.williams3@gmail.com", crypted_password: "e8397c079d74ecb0584229ee73dd00a507ebae7f82966133d08...", password_salt: "wfDdcHm3--pkg47_4Ots", persistence_token: "4ba5848d839bcc1cbd1a2451b6753d2115f1b9f95b054bed8e8...", created_at: "2010-08-13 09:45:04", updated_at: "2010-09-22 14:49:13", roles_mask: 1, organization_id: 3954, data_response_id_current: 6658, text_for_organization: nil, full_name: nil>, #<User id: 2091, username: "regis.hitimana@moh.gov.rw", email: "regis.hitimana@moh.gov.rw", crypted_password: "6661417b34e9270548fe428d031a7a06027541ef3e4ecac79c2...", password_salt: "fustha9gICSPQiiNZ1", persistence_token: "f4d27d0f449795157215c064d4c5ffcaa20659c0de9b6e08dfc...", created_at: "2010-08-13 08:55:07", updated_at: "2010-09-22 14:49:13", roles_mask: 1, organization_id: 3954, data_response_id_current: 6658, text_for_organization: nil, full_name: nil>, #<User id: 2152, username: "kayirangwae", email: "kayirangwae@rw.cdc.gov", crypted_password: "dc083874acc6fda4c7ba243b87a0e9380f4d5fd967e59fefe23...", password_salt: "DU6ybVf2QIB3oN9Fot8N", persistence_token: "a1e8bd936d7e87a3c20265a2f57305a16d6bc6f035df3d06d47...", created_at: "2010-09-06 14:53:29", updated_at: "2010-09-22 14:49:13", roles_mask: 4, organization_id: 3954, data_response_id_current: 6658, text_for_organization: nil, full_name: "Eugenie Kayirangwa">, #<User id: 2196, username: "mukunzi", email: "jlou.mukunzi@gmail.com", crypted_password: "9eba4539848e12f580c11d451c993325ad72b8d57252258a66b...", password_salt: "1iGlEBgnIOFxGxrCYNI4", persistence_token: "51f70f4607614933465416d8fa10791fabf17adc4ad3095e6d6...", created_at: "2010-09-08 12:08:01", updated_at: "2010-09-22 14:47:30", roles_mask: 1, organization_id: 3954, data_response_id_current: 6658, text_for_organization: nil, full_name: nil>, #<User id: 2225, username: "Ithiel", email: "mukwesij@yahoo.fr", crypted_password: "7dc6a2d4ac4af0dfde9da27c2308a0be9f5e5588debe92fad54...", password_salt: "nbJpvLEuGIrYONmXdR7N", persistence_token: "481538444dc3d65484703f91a2b3d02f4807d76c9f1c98dfc43...", created_at: "2010-09-21 08:51:10", updated_at: "2010-09-21 12:31:53", roles_mask: 2, organization_id: 3954, data_response_id_current: 6658, text_for_organization: nil, full_name: nil>, #<User id: 2232, username: "kayigery@yahoo.fr", email: "kayigery@yahoo.fr", crypted_password: "1932315b80cb41788f0c7eecccd16d1887608070334acec4432...", password_salt: "9Wf9KL0M9Uxt3sUVZ6Gc", persistence_token: "5907de6576eb175dd0f527bc997513923b3b03ec2f24436de0a...", created_at: "2010-09-21 09:02:00", updated_at: "2010-09-22 14:49:13", roles_mask: 2, organization_id: 3954, data_response_id_current: 6658, text_for_organization: nil, full_name: nil>, #<User id: 2246, username: "mbajean@yahoo.fr", email: "mbajean@yahoo.fr", crypted_password: "29cbe81e567b09d46ddd10d4b5aa1d3b5fa1b95686ab2bbf5f0...", password_salt: "3m3HWhWNAOpLDJpEMT9P", persistence_token: "409e66828f2cb234a87a59a7498f154ca632720a2650dc574d5...", created_at: "2010-09-21 12:29:03", updated_at: "2010-09-21 12:30:10", roles_mask: 2, organization_id: 3954, data_response_id_current: 6658, text_for_organization: nil, full_name: nil>, #<User id: 2250, username: "bajyadona@gmail.com", email: "bajyadona@gmail.com", crypted_password: "1e97c344c1efb2f59518b5c5977457054e719ad60e56c3eeee3...", password_salt: "BHdBvExUzj9j8y8BAshq", persistence_token: "f11bb4f45ef6b2f7a3da7fbb9ffe78e9701cc5e7742c607b9d0...", created_at: "2010-09-21 12:50:28", updated_at: "2010-09-21 12:52:41", roles_mask: 2, organization_id: 3954, data_response_id_current: 6658, text_for_organization: nil, full_name: nil>, #<User id: 2251, username: "maniraguharuth@yahoo.fr", email: "maniraguharuth@yahoo.fr", crypted_password: "877d823ff728f901a62128e851b7afef0c0205e4fe720dd4842...", password_salt: "MpBV5GHeNzQdYbd0YJV", persistence_token: "c591f64eb5b0329a00734ce9800a05a4078014e8c0e0e6c5ab0...", created_at: "2010-09-21 12:55:29", updated_at: "2010-09-21 12:56:10", roles_mask: 2, organization_id: 3954, data_response_id_current: 6658, text_for_organization: nil, full_name: nil>, #<User id: 2253, username: "mat_mic2001@yahoo.fr", email: "mat_mic2001@yahoo.fr", crypted_password: "d2da77a3ae93eacf624d39d9546704e6ca79058ff651cfeb3a9...", password_salt: "oIgN8QIcn3euTKcxlIP", persistence_token: "1efd35cf5189e8144db3b18cec88e5df6d43cb8e547270a8919...", created_at: "2010-09-21 13:26:54", updated_at: "2010-09-21 13:27:55", roles_mask: 2, organization_id: 3954, data_response_id_current: 6658, text_for_organization: nil, full_name: nil>, #<User id: 2254, username: "fidele.karangwa@gmail.com", email: "fidele.karangwa@gmail.com", crypted_password: "f60a582cd20c0d13a66ec71aaf523c8ef643490584c299b3294...", password_salt: "MKD1nnit27D9IDHRUzs1", persistence_token: "7d1e622a939f4ad1dc6d878d31e5ce91e81661f6bce6fd40385...", created_at: "2010-09-21 13:51:23", updated_at: "2010-09-21 13:54:00", roles_mask: 2, organization_id: 3954, data_response_id_current: 6658, text_for_organization: nil, full_name: nil>, #<User id: 2258, username: "nzizera@gmail.com", email: "nzizera@gmail.com", crypted_password: "709e2f0cc1bb71d1851d6165cc22c37bcd306c8c544cd6f771b...", password_salt: "pm47d69X3LYHAidcRKiU", persistence_token: "3a033fbd36b78e1c87a933a6685d38522530eef895d55866138...", created_at: "2010-09-22 07:26:25", updated_at: "2010-09-22 14:47:30", roles_mask: 2, organization_id: 3954, data_response_id_current: 6658, text_for_organization: nil, full_name: nil>, #<User id: 2247, username: "claudinion@gmail.com", email: "claudinion@gmail.com", crypted_password: "35ea367546f07bb07f48a46c7e0770be731e101e3df03d5a091...", password_salt: "HVmm01SUmgRExOUH8FMJ", persistence_token: "b801153d9211dac7f272002dc372cada7a41fcc15c5b052bbb1...", created_at: "2010-09-21 12:33:05", updated_at: "2010-09-22 07:09:54", roles_mask: 2, organization_id: 3954, data_response_id_current: 6658, text_for_organization: nil, full_name: nil>, #<User id: 2249, username: "watuma2001@yahoo.fr", email: "watuma2001@yahoo.fr", crypted_password: "4e119980ec32e8459a4ec1341ae32476a7405039a864782cbe3...", password_salt: "CiCSp77WL5DSmVtfbzO", persistence_token: "11e02563574752361220ef961db45c654cd3d7d2f47585cc460...", created_at: "2010-09-21 12:37:32", updated_at: "2010-09-22 12:26:07", roles_mask: 2, organization_id: 3954, data_response_id_current: 6658, text_for_organization: nil, full_name: nil>, #<User id: 2256, username: "moh", email: "moh@moh.org", crypted_password: "04c0a36d26e8d9d7b67e9fa2bcd23323d6398ab939fe6885680...", password_salt: "8WVhfhAf9yWlWLVfJM2", persistence_token: "57db72c7d4a459d8bec3eb23e790e4b58769e9446f4ff302ef6...", created_at: "2010-09-21 14:13:02", updated_at: "2010-09-22 14:51:17", roles_mask: 2, organization_id: 3954, data_response_id_current: 6658, text_for_organization: nil, full_name: nil>, #<User id: 2255, username: "josemashav@yahoo.fr", email: "josemashav@yahoo.fr", crypted_password: "8e31e13eb7da6be0608f79184c008bc1911d954f852631e241c...", password_salt: "P1yUyAoPtMLqSQRhkf6f", persistence_token: "70ff5ea65f4099d6c9b6499546b3124ed43f3192c37554866f7...", created_at: "2010-09-21 14:07:34", updated_at: "2010-09-22 14:51:17", roles_mask: 2, organization_id: 3954, data_response_id_current: 6658, text_for_organization: nil, full_name: nil>]
>> old_org       = Organization.find 3999
=> #<Organization id: 3999, name: "Ministry of Gender and Family Promotion", type: nil, created_at: "2010-08-31 11:01:52", updated_at: "2010-08-31 11:01:52", raw_type: nil>
>> puts "Found #{old_org.activities.count} activities"
Found 0 activities
=> nil
>> old_org.activities.each { |a| puts "  Updating activity #{a.id} by Org: #{a.organization}" }

=> []
>>
>> FundingFlow.find_all_by_organization_id_from(old_org.id).each { |fflow| puts "  Updating fflow #{fflow.id} by Org: #{fflow.data_response.responding_organization}" }

=> []
>>
>> FundingFlow.find_all_by_organization_id_to(old_org.id).each { |fflow| puts "  Updating fflow #{fflow.id} by Org: #{fflow.data_response.responding_organization}" }

=> []
>>
>> old_org.locations
=> []
>>     old_org.users.each { |u| puts "moving user #{u.email}..." }
=> []
>>     old_org.users.each { |u| u.organization = Organization.find(3954); u.data_response_id_current = Organization.find(3954).data_responses.first.id; u.save! }
=> []
>>
>>     old_org.destroy

=> #<Organization id: 3999, name: "Ministry of Gender and Family Promotion", type: nil, created_at: "2010-08-31 11:01:52", updated_at: "2010-08-31 11:01:52", raw_type: nil>
>>
>>     old_org.users.each { |u| u.organization = Organization.find(3954); u.data_response_id_current = Organization.find(3954).data_responses.first.id; u.save! }


[canceled]
gr-siyelo ~/c/resource_tracking[datafixes*]$ hcon --app resourcetracking
Ruby console for resourcetracking.heroku.com
>> new_org       = Organization.find(3954)
=> #<Organization id: 3954, name: "Ministry of Health", type: nil, created_at: "2010-08-25 22:38:49", updated_at: "2010-09-22 13:58:31", raw_type: nil>
>> Organization.create! :name => "Ministry of Gender and Family Promotion"
=> #<Organization id: 4126, name: "Ministry of Gender and Family Promotion", type: nil, created_at: "2010-09-22 14:54:18", updated_at: "2010-09-22 14:54:18", raw_type: nil>
>> old_org       = Organization.find 4005
=> #<Organization id: 4005, name: "Ministry of Health ", type: nil, created_at: "2010-08-31 12:01:36", updated_at: "2010-08-31 12:01:36", raw_type: nil>
>> puts "Found #{old_org.activities.count} activities"
Found 1 activities
=> nil
>> old_org.activities.each { |a| puts "  Updating activity #{a.id} by Org: #{a.organization}" }

  Updating activity 1862 by Org: Concern
=> [#<Activity id: 1862, name: nil, beneficiary: nil, target: nil, created_at: "2010-09-10 10:05:49", updated_at: "2010-09-10 10:05:49", provider_id: 3960, other_cost_type_id: nil, description: "Support to district or national level for nutrition...", type: nil, budget: #<BigDecimal:2aaacc3d8028,'0.7315E4',9(18)>, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, start: "2010-07-01", end: "2011-03-31", spend: #<BigDecimal:2aaacc3d3a78,'0.0',9(18)>, text_for_provider: nil, text_for_targets: nil, text_for_beneficiaries: nil, spend_q4_prev: nil, data_response_id: 6525, activity_id: 1862, budget_percentage: nil, spend_percentage: nil, approved: nil>]
>>
>> old_org.activities.each { |a| a.organizations.delete(old_org); a.organizations.push(Organization.find(3954)) }

=> [#<Activity id: 1862, name: nil, beneficiary: nil, target: nil, created_at: "2010-09-10 10:05:49", updated_at: "2010-09-10 10:05:49", provider_id: 3960, other_cost_type_id: nil, description: "Support to district or national level for nutrition...", type: nil, budget: #<BigDecimal:2aaacc3c2368,'0.7315E4',9(18)>, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, start: "2010-07-01", end: "2011-03-31", spend: #<BigDecimal:2aaacc3bd4d0,'0.0',9(18)>, text_for_provider: nil, text_for_targets: nil, text_for_beneficiaries: nil, spend_q4_prev: nil, data_response_id: 6525, activity_id: 1862, budget_percentage: nil, spend_percentage: nil, approved: nil>]
>>
>> FundingFlow.find_all_by_organization_id_from(old_org.id).each { |fflow| puts "  Updating fflow #{fflow.id} by Org: #{fflow.data_response.responding_organization}" }

=> []
>>
>> FundingFlow.find_all_by_organization_id_to(old_org.id).each { |fflow| puts "  Updating fflow #{fflow.id} by Org: #{fflow.data_response.responding_organization}" }

=> []
>>
>>  old_org.locations

=> []
>>
>> old_org.users.each { |u| puts "moving user #{u.email}..." }

moving user gatete@gmail.com...
=> [#<User id: 2239, username: "gatete@gmail.com", email: "gatete@gmail.com", crypted_password: "4161774982bf0595f348a8581d887a80f4ffca62b9fb54d4331...", password_salt: "Js8p2awehxabAzw2ew7h", persistence_token: "322cf94db8298ed4ccfcef9ca37704034cb179e3939f540e111...", created_at: "2010-09-21 09:16:47", updated_at: "2010-09-21 09:16:47", roles_mask: 1, organization_id: 4005, data_response_id_current: nil, text_for_organization: nil, full_name: nil>]
>>
>> old_org.users.each { |u| u.organization = Organization.find(3954); u.data_response_id_current = Organization.find(3954).data_responses.first.id; u.save! }

=> [#<User id: 2239, username: "gatete@gmail.com", email: "gatete@gmail.com", crypted_password: "4161774982bf0595f348a8581d887a80f4ffca62b9fb54d4331...", password_salt: "Js8p2awehxabAzw2ew7h", persistence_token: "322cf94db8298ed4ccfcef9ca37704034cb179e3939f540e111...", created_at: "2010-09-21 09:16:47", updated_at: "2010-09-22 14:55:26", roles_mask: 1, organization_id: 3954, data_response_id_current: 6658, text_for_organization: nil, full_name: nil>]
>>
>> old_org.destroy

=> #<Organization id: 4005, name: "Ministry of Health ", type: nil, created_at: "2010-08-31 12:01:36", updated_at: "2010-08-31 12:01:36", raw_type: nil>
>>
>>   old_org       = Organization.find 4007

=> #<Organization id: 4007, name: "Ministry of Gender and family Promotion", type: nil, created_at: "2010-08-31 12:40:53", updated_at: "2010-08-31 12:40:53", raw_type: nil>
>>
>>   old_org       = Organization.find 4007
=> #<Organization id: 4007, name: "Ministry of Gender and family Promotion", type: nil, created_at: "2010-08-31 12:40:53", updated_at: "2010-08-31 12:40:53", raw_type: nil>
>> puts "Found #{old_org.activities.count} activities"
Found 1 activities
=> nil
>> Organization.find(4126)
=> #<Organization id: 4126, name: "Ministry of Gender and Family Promotion", type: nil, created_at: "2010-09-22 14:54:18", updated_at: "2010-09-22 14:54:18", raw_type: nil>
>> Organization.find(4126).users
=> []
>> Organization.find(4126).destroy
=> #<Organization id: 4126, name: "Ministry of Gender and Family Promotion", type: nil, created_at: "2010-09-22 14:54:18", updated_at: "2010-09-22 14:54:18", raw_type: nil>
>> old_org       = Organization.find 4008
ActiveRecord::RecordNotFound: Couldn't find Organization with ID=4008
>> Organization.all.collect{|o| o if o.name.downcase.include? "inistry"}.uniq
NoMethodError: undefined method `downcase' for nil:NilClass
>> Organization.all.collect{|o| o if o && o.name.downcase.include? "inistry"}.uniq
SyntaxError: compile error
/home/heroku_rack/lib/console.rb:145: syntax error, unexpected tSTRING_BEG, expecting '}'
... && o.name.downcase.include? "inistry"}.uniq
                              ^
>> Organization.all.collect{|o| o if o.name.downcase.include? "inistry" && !o.nil?}.uniq
TypeError: can't convert true into String
>> Organization.all.collect{|o| o if(!o.nil?) && (o.name.downcase.include? "inistry")}.uniq
NoMethodError: undefined method `downcase' for nil:NilClass
>> Organization.all.collect{|o| o if(!o.name.nil?) && (o.name.downcase.include? "inistry")}.uniq
=> [nil, #<Organization id: 3954, name: "Ministry of Health", type: nil, created_at: "2010-08-25 22:38:49", updated_at: "2010-09-22 13:58:31", raw_type: nil>, #<Organization id: 4007, name: "Ministry of Gender and family Promotion", type: nil, created_at: "2010-08-31 12:40:53", updated_at: "2010-08-31 12:40:53", raw_type: nil>, #<Ngo id: 4050, name: "Ministry of Health", type: "Ngo", created_at: "2010-09-01 14:54:48", updated_at: "2010-09-01 14:54:48", raw_type: nil>, #<Donor id: 4117, name: "Ministry of health", type: "Donor", created_at: "2010-09-22 09:50:21", updated_at: "2010-09-22 09:50:21", raw_type: nil>]
>> old_org       = Organization.find 4050
=> #<Ngo id: 4050, name: "Ministry of Health", type: "Ngo", created_at: "2010-09-01 14:54:48", updated_at: "2010-09-01 14:54:48", raw_type: nil>
>> old_org.users
=> []
>> puts "Found #{old_org.activities.count} activities"

Found 0 activities
=> nil
>>
>> old_org.activities.each { |a| puts "  Updating activity #{a.id} by Org: #{a.organization}" }

=> []
>>
>> FundingFlow.find_all_by_organization_id_from(old_org.id).each { |fflow| puts "  Updating fflow #{fflow.id} by Org: #{fflow.data_response.responding_organization}" }

=> []
>>
>> FundingFlow.find_all_by_organization_id_to(old_org.id).each { |fflow| puts "  Updating fflow #{fflow.id} by Org: #{fflow.data_response.responding_organization}" }

  Updating fflow 838 by Org: WHO
  Updating fflow 886 by Org: WHO
  Updating fflow 864 by Org: WHO
  Updating fflow 866 by Org: WHO
  Updating fflow 868 by Org: WHO
  Updating fflow 870 by Org: WHO
  Updating fflow 872 by Org: WHO
  Updating fflow 877 by Org: WHO
  Updating fflow 879 by Org: WHO
  Updating fflow 882 by Org: WHO
  Updating fflow 1178 by Org: Ministry of Health
  Updating fflow 1228 by Org: Ministry of Health
  Updating fflow 1230 by Org: Ministry of Health
=> [#<FundingFlow id: 838, organization_id_from: 3076, organization_id_to: 4050, project_id: 217, created_at: "2010-09-01 15:55:24", updated_at: "2010-09-01 15:59:27", budget: #<BigDecimal:2aaacc49eca0,'0.16145E7',9(18)>, spend_q1: #<BigDecimal:2aaacc49ec00,'0.7475E5',9(18)>, spend_q2: #<BigDecimal:2aaacc49eb60,'0.81292E5',9(18)>, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 0, spend: #<BigDecimal:2aaacc49e868,'0.156042E6',9(18)>, spend_q4_prev: #<BigDecimal:2aaacc49e7c8,'0.96199E6',9(18)>, data_response_id: 5925>, #<FundingFlow id: 886, organization_id_from: 3076, organization_id_to: 4050, project_id: 234, created_at: "2010-09-02 09:06:01", updated_at: "2010-09-02 09:07:28", budget: #<BigDecimal:2aaacc49ddf0,'0.26E5',9(18)>, spend_q1: #<BigDecimal:2aaacc49dd50,'0.6E4',9(18)>, spend_q2: #<BigDecimal:2aaacc49dcb0,'0.22874E5',9(18)>, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 1, spend: #<BigDecimal:2aaacc49da08,'0.28874E5',9(18)>, spend_q4_prev: #<BigDecimal:2aaacc49d968,'0.23365E5',9(18)>, data_response_id: 5925>, #<FundingFlow id: 864, organization_id_from: 3076, organization_id_to: 4050, project_id: 224, created_at: "2010-09-02 07:29:55", updated_at: "2010-09-02 07:32:34", budget: #<BigDecimal:2aaacc49cf40,'0.305E5',9(18)>, spend_q1: #<BigDecimal:2aaacc49cea0,'0.0',9(18)>, spend_q2: #<BigDecimal:2aaacc49ce00,'0.0',9(18)>, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 1, spend: #<BigDecimal:2aaacc49cba8,'0.0',9(18)>, spend_q4_prev: #<BigDecimal:2aaacc49cb08,'0.27331E5',9(18)>, data_response_id: 5925>, #<FundingFlow id: 866, organization_id_from: 3076, organization_id_to: 4050, project_id: 225, created_at: "2010-09-02 07:41:57", updated_at: "2010-09-02 07:44:40", budget: #<BigDecimal:2aaacc49c248,'0.182E6',9(18)>, spend_q1: #<BigDecimal:2aaacc49c1a8,'0.12E5',9(18)>, spend_q2: #<BigDecimal:2aaacc49c0b8,'0.2936E4',9(18)>, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 1, spend: #<BigDecimal:2aaacc49beb0,'0.14936E5',9(18)>, spend_q4_prev: #<BigDecimal:2aaacc49be10,'0.5335E5',9(18)>, data_response_id: 5925>, #<FundingFlow id: 868, organization_id_from: 3076, organization_id_to: 4050, project_id: 226, created_at: "2010-09-02 07:59:22", updated_at: "2010-09-02 08:07:39", budget: #<BigDecimal:2aaacc499868,'0.4795E6',9(18)>, spend_q1: #<BigDecimal:2aaacc4997c8,'0.23452E5',9(18)>, spend_q2: #<BigDecimal:2aaacc4996b0,'0.14357E5',9(18)>, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 1, spend: #<BigDecimal:2aaacc498fd0,'0.37809E5',9(18)>, spend_q4_prev: #<BigDecimal:2aaacc498f30,'0.8102E4',9(18)>, data_response_id: 5925>, #<FundingFlow id: 870, organization_id_from: 3076, organization_id_to: 4050, project_id: 227, created_at: "2010-09-02 08:15:14", updated_at: "2010-09-02 08:19:06", budget: #<BigDecimal:2aaacc498210,'0.21E5',9(18)>, spend_q1: #<BigDecimal:2aaacc498148,'0.1859E4',9(18)>, spend_q2: #<BigDecimal:2aaacc4980a8,'0.49368E5',9(18)>, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 1, spend: #<BigDecimal:2aaacc497db0,'0.51227E5',9(18)>, spend_q4_prev: #<BigDecimal:2aaacc497cc0,'0.36188E5',9(18)>, data_response_id: 5925>, #<FundingFlow id: 872, organization_id_from: 3076, organization_id_to: 4050, project_id: 228, created_at: "2010-09-02 08:25:45", updated_at: "2010-09-02 08:27:37", budget: #<BigDecimal:2aaacc497220,'0.45E5',9(18)>, spend_q1: #<BigDecimal:2aaacc497180,'0.34834E5',9(18)>, spend_q2: #<BigDecimal:2aaacc4970b8,'0.0',9(18)>, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 1, spend: #<BigDecimal:2aaacc496ed8,'0.34834E5',9(18)>, spend_q4_prev: #<BigDecimal:2aaacc496e38,'0.68156E5',9(18)>, data_response_id: 5925>, #<FundingFlow id: 877, organization_id_from: 3076, organization_id_to: 4050, project_id: 230, created_at: "2010-09-02 08:36:55", updated_at: "2010-09-02 08:39:10", budget: #<BigDecimal:2aaacc496320,'0.17E5',9(18)>, spend_q1: #<BigDecimal:2aaacc496280,'0.95E4',9(18)>, spend_q2: #<BigDecimal:2aaacc4961e0,'0.2306E4',9(18)>, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 1, spend: #<BigDecimal:2aaacc495fb0,'0.11806E5',9(18)>, spend_q4_prev: #<BigDecimal:2aaacc495f10,'0.8824E4',9(18)>, data_response_id: 5925>, #<FundingFlow id: 879, organization_id_from: 3076, organization_id_to: 4050, project_id: 231, created_at: "2010-09-02 08:47:08", updated_at: "2010-09-02 08:52:33", budget: #<BigDecimal:2aaacc495358,'0.1285E6',9(18)>, spend_q1: #<BigDecimal:2aaacc495240,'0.26639E5',9(18)>, spend_q2: #<BigDecimal:2aaacc4951a0,'0.0',9(18)>, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 1, spend: #<BigDecimal:2aaacc494f48,'0.26639E5',9(18)>, spend_q4_prev: #<BigDecimal:2aaacc494ea8,'0.96894E5',9(18)>, data_response_id: 5925>, #<FundingFlow id: 882, organization_id_from: 3076, organization_id_to: 4050, project_id: 232, created_at: "2010-09-02 08:58:45", updated_at: "2010-09-02 09:00:15", budget: #<BigDecimal:2aaacc4945c0,'0.4435E6',9(18)>, spend_q1: #<BigDecimal:2aaacc494520,'0.10746E5',9(18)>, spend_q2: #<BigDecimal:2aaacc494408,'0.52556E5',9(18)>, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 1, spend: #<BigDecimal:2aaacc4941d8,'0.63302E5',9(18)>, spend_q4_prev: #<BigDecimal:2aaacc494138,'0.12967E5',9(18)>, data_response_id: 5925>, #<FundingFlow id: 1178, organization_id_from: 3954, organization_id_to: 4050, project_id: 362, created_at: "2010-09-22 08:14:00", updated_at: "2010-09-22 08:14:00", budget: #<BigDecimal:2aaacc4938f0,'0.51324539E8',9(18)>, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 0, spend: nil, spend_q4_prev: nil, data_response_id: 6658>, #<FundingFlow id: 1228, organization_id_from: nil, organization_id_to: 4050, project_id: 364, created_at: "2010-09-22 10:16:00", updated_at: "2010-09-22 10:16:00", budget: #<BigDecimal:2aaacc492dd8,'0.18154E8',9(18)>, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 0, spend: nil, spend_q4_prev: nil, data_response_id: 6658>, #<FundingFlow id: 1230, organization_id_from: 3076, organization_id_to: 4050, project_id: 364, created_at: "2010-09-22 10:20:46", updated_at: "2010-09-22 10:38:36", budget: #<BigDecimal:2aaacc4921f8,'0.76976884E8',9(18)>, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 0, spend: nil, spend_q4_prev: nil, data_response_id: 6658>]
>>
>> FundingFlow.find_all_by_organization_id_to(old_org.id).each { |fflow| fflow.organization_id_to = Organization.find(3954).id; fflow.save! }

=> [#<FundingFlow id: 838, organization_id_from: 3076, organization_id_to: 3954, project_id: 217, created_at: "2010-09-01 15:55:24", updated_at: "2010-09-22 15:00:16", budget: #<BigDecimal:2aaacc3c6558,'0.16145E7',9(18)>, spend_q1: #<BigDecimal:2aaacc3c64b8,'0.7475E5',9(18)>, spend_q2: #<BigDecimal:2aaacc3c63f0,'0.81292E5',9(18)>, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 0, spend: #<BigDecimal:2aaacc3c61e8,'0.156042E6',9(18)>, spend_q4_prev: #<BigDecimal:2aaacc3c6148,'0.96199E6',9(18)>, data_response_id: 5925>, #<FundingFlow id: 886, organization_id_from: 3076, organization_id_to: 3954, project_id: 234, created_at: "2010-09-02 09:06:01", updated_at: "2010-09-22 15:00:16", budget: #<BigDecimal:2aaacc3c5b30,'0.26E5',9(18)>, spend_q1: #<BigDecimal:2aaacc3c5a90,'0.6E4',9(18)>, spend_q2: #<BigDecimal:2aaacc3c59f0,'0.22874E5',9(18)>, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 1, spend: #<BigDecimal:2aaacc3c56f8,'0.28874E5',9(18)>, spend_q4_prev: #<BigDecimal:2aaacc3c5658,'0.23365E5',9(18)>, data_response_id: 5925>, #<FundingFlow id: 864, organization_id_from: 3076, organization_id_to: 3954, project_id: 224, created_at: "2010-09-02 07:29:55", updated_at: "2010-09-22 15:00:16", budget: #<BigDecimal:2aaacc3c4ff0,'0.305E5',9(18)>, spend_q1: #<BigDecimal:2aaacc3c4f50,'0.0',9(18)>, spend_q2: #<BigDecimal:2aaacc3c4eb0,'0.0',9(18)>, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 1, spend: #<BigDecimal:2aaacc3c4c58,'0.0',9(18)>, spend_q4_prev: #<BigDecimal:2aaacc3c4bb8,'0.27331E5',9(18)>, data_response_id: 5925>, #<FundingFlow id: 866, organization_id_from: 3076, organization_id_to: 3954, project_id: 225, created_at: "2010-09-02 07:41:57", updated_at: "2010-09-22 15:00:16", budget: #<BigDecimal:2aaacc3c2908,'0.182E6',9(18)>, spend_q1: #<BigDecimal:2aaacc3c2868,'0.12E5',9(18)>, spend_q2: #<BigDecimal:2aaacc3c2778,'0.2936E4',9(18)>, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 1, spend: #<BigDecimal:2aaacc3c24d0,'0.14936E5',9(18)>, spend_q4_prev: #<BigDecimal:2aaacc3c23e0,'0.5335E5',9(18)>, data_response_id: 5925>, #<FundingFlow id: 868, organization_id_from: 3076, organization_id_to: 3954, project_id: 226, created_at: "2010-09-02 07:59:22", updated_at: "2010-09-22 15:00:16", budget: #<BigDecimal:2aaacc3c1df0,'0.4795E6',9(18)>, spend_q1: #<BigDecimal:2aaacc3c1d50,'0.23452E5',9(18)>, spend_q2: #<BigDecimal:2aaacc3c1c88,'0.14357E5',9(18)>, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 1, spend: #<BigDecimal:2aaacc3c1aa8,'0.37809E5',9(18)>, spend_q4_prev: #<BigDecimal:2aaacc3c19e0,'0.8102E4',9(18)>, data_response_id: 5925>, #<FundingFlow id: 870, organization_id_from: 3076, organization_id_to: 3954, project_id: 227, created_at: "2010-09-02 08:15:14", updated_at: "2010-09-22 15:00:16", budget: #<BigDecimal:2aaacc3c1210,'0.21E5',9(18)>, spend_q1: #<BigDecimal:2aaacc3c1120,'0.1859E4',9(18)>, spend_q2: #<BigDecimal:2aaacc3c1058,'0.49368E5',9(18)>, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 1, spend: #<BigDecimal:2aaacc3c0e50,'0.51227E5',9(18)>, spend_q4_prev: #<BigDecimal:2aaacc3c0d88,'0.36188E5',9(18)>, data_response_id: 5925>, #<FundingFlow id: 872, organization_id_from: 3076, organization_id_to: 3954, project_id: 228, created_at: "2010-09-02 08:25:45", updated_at: "2010-09-22 15:00:16", budget: #<BigDecimal:2aaacc3c06d0,'0.45E5',9(18)>, spend_q1: #<BigDecimal:2aaacc3c0630,'0.34834E5',9(18)>, spend_q2: #<BigDecimal:2aaacc3c0590,'0.0',9(18)>, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 1, spend: #<BigDecimal:2aaacc3c03b0,'0.34834E5',9(18)>, spend_q4_prev: #<BigDecimal:2aaacc3c0310,'0.68156E5',9(18)>, data_response_id: 5925>, #<FundingFlow id: 877, organization_id_from: 3076, organization_id_to: 3954, project_id: 230, created_at: "2010-09-02 08:36:55", updated_at: "2010-09-22 15:00:16", budget: #<BigDecimal:2aaacc3bfcd0,'0.17E5',9(18)>, spend_q1: #<BigDecimal:2aaacc3bfc08,'0.95E4',9(18)>, spend_q2: #<BigDecimal:2aaacc3bfb40,'0.2306E4',9(18)>, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 1, spend: #<BigDecimal:2aaacc3bf8e8,'0.11806E5',9(18)>, spend_q4_prev: #<BigDecimal:2aaacc3bf848,'0.8824E4',9(18)>, data_response_id: 5925>, #<FundingFlow id: 879, organization_id_from: 3076, organization_id_to: 3954, project_id: 231, created_at: "2010-09-02 08:47:08", updated_at: "2010-09-22 15:00:16", budget: #<BigDecimal:2aaacc3bf230,'0.1285E6',9(18)>, spend_q1: #<BigDecimal:2aaacc3bf190,'0.26639E5',9(18)>, spend_q2: #<BigDecimal:2aaacc3bf0f0,'0.0',9(18)>, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 1, spend: #<BigDecimal:2aaacc3bef10,'0.26639E5',9(18)>, spend_q4_prev: #<BigDecimal:2aaacc3bee20,'0.96894E5',9(18)>, data_response_id: 5925>, #<FundingFlow id: 882, organization_id_from: 3076, organization_id_to: 3954, project_id: 232, created_at: "2010-09-02 08:58:45", updated_at: "2010-09-22 15:00:16", budget: #<BigDecimal:2aaacc3be768,'0.4435E6',9(18)>, spend_q1: #<BigDecimal:2aaacc3be6c8,'0.10746E5',9(18)>, spend_q2: #<BigDecimal:2aaacc3be628,'0.52556E5',9(18)>, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 1, spend: #<BigDecimal:2aaacc3be448,'0.63302E5',9(18)>, spend_q4_prev: #<BigDecimal:2aaacc3be3a8,'0.12967E5',9(18)>, data_response_id: 5925>, #<FundingFlow id: 1178, organization_id_from: 3954, organization_id_to: 3954, project_id: 362, created_at: "2010-09-22 08:14:00", updated_at: "2010-09-22 15:00:16", budget: #<BigDecimal:2aaacc3bdd40,'0.51324539E8',9(18)>, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 0, spend: nil, spend_q4_prev: nil, data_response_id: 6658>, #<FundingFlow id: 1228, organization_id_from: nil, organization_id_to: 3954, project_id: 364, created_at: "2010-09-22 10:16:00", updated_at: "2010-09-22 15:00:16", budget: #<BigDecimal:2aaacc3bcfd0,'0.18154E8',9(18)>, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 0, spend: nil, spend_q4_prev: nil, data_response_id: 6658>, #<FundingFlow id: 1230, organization_id_from: 3076, organization_id_to: 3954, project_id: 364, created_at: "2010-09-22 10:20:46", updated_at: "2010-09-22 15:00:16", budget: #<BigDecimal:2aaacc3bc2b0,'0.76976884E8',9(18)>, spend_q1: nil, spend_q2: nil, spend_q3: nil, spend_q4: nil, organization_text: nil, self_provider_flag: 0, spend: nil, spend_q4_prev: nil, data_response_id: 6658>]
>>
>> old_org.locations
=> []
>>     old_org.users.each { |u| puts "moving user #{u.email}..." }

=> []
>>
>>     old_org.destroy

=> #<Ngo id: 4050, name: "Ministry of Health", type: "Ngo", created_at: "2010-09-01 14:54:48", updated_at: "2010-09-01 14:54:48", raw_type: nil>
>>
>> Organization.all.collect{|o| o if(!o.name.nil?) && (o.name.downcase.include? "inistry")}.uniq=> [nil, #<Organization id: 3954, name: "Ministry of Health", type: nil, created_at: "2010-08-25 22:38:49", updated_at: "2010-09-22 13:58:31", raw_type: nil>, #<Organization id: 4007, name: "Ministry of Gender and family Promotion", type: nil, created_at: "2010-08-31 12:40:53", updated_at: "2010-08-31 12:40:53", raw_type: nil>, #<Donor id: 4117, name: "Ministry of health", type: "Donor", created_at: "2010-09-22 09:50:21", updated_at: "2010-09-22 09:50:21", raw_type: nil>]
>> old_org       = Organization.find 4117
=> #<Donor id: 4117, name: "Ministry of health", type: "Donor", created_at: "2010-09-22 09:50:21", updated_at: "2010-09-22 09:50:21", raw_type: nil>
>>  old_org.users
=> []
>> puts "Found #{old_org.activities.count} activities"
Found 0 activities
=> nil
>>   FundingFlow.find_all_by_organization_id_from(old_org.id).each { |fflow| puts "  Updating fflow #{fflow.id} by Org: #{fflow.data_response.responding_organization}" }

=> []
>>
>>   FundingFlow.find_all_by_organization_id_to(old_org.id).each { |fflow| puts "  Updating fflow #{fflow.id} by Org: #{fflow.data_response.responding_organization}" }

=> []
>>
>>   old_org.locations

=> []
>>
>>   old_org.users.each { |u| puts "moving user #{u.email}..." }
=> []
>>     old_org.destroy

=> #<Donor id: 4117, name: "Ministry of health", type: "Donor", created_at: "2010-09-22 09:50:21", updated_at: "2010-09-22 09:50:21", raw_type: nil>
>>
>> Organization.last
=> #<Organization id: 4125, name: "RECETTES SCPS", type: nil, created_at: "2010-09-22 14:36:18", updated_at: "2010-09-22 14:36:18", raw_type: nil>
>>





### While doing some cross-checking - found the issue with the MoH records - the DR wasnt pointing to the right Org


>> Organization.all.collect{|o| o if (o.name) && (o.name.downcase.include? "inistry")}.uniq
=> [nil, #<Organization id: 3954, name: "Ministry of Health", type: nil, created_at: "2010-08-25 22:38:49", updated_at: "2010-09-22 18:03:27", raw_type: nil>, #<Organization id: 4007, name: "Ministry of Gender and family Promotion", type: nil, created_at: "2010-08-31 12:40:53", updated_at: "2010-08-31 12:40:53", raw_type: nil>]
>> DataResponse.find(6600).responding_organization=> nil
>> DataResponse.find 6600=> #<DataResponse id: 6600, data_element_id: nil, data_request_id: 8, complete: false, created_at: "2010-08-05 14:24:58", updated_at: "2010-09-22 06:52:51", organization_id_responder: 3896, currency: "", fiscal_year_start_date: "2010-07-01", fiscal_year_end_date: "2011-06-30", contact_name: "KAYISETI Germaine", contact_position: "Financial Assistant", contact_phone_number: "0788441327", contact_main_office_phone_number: "", contact_office_location: "KICUKIRO">
>> d = DataResponse.find 6600
=> #<DataResponse id: 6600, data_element_id: nil, data_request_id: 8, complete: false, created_at: "2010-08-05 14:24:58", updated_at: "2010-09-22 06:52:51", organization_id_responder: 3896, currency: "", fiscal_year_start_date: "2010-07-01", fiscal_year_end_date: "2011-06-30", contact_name: "KAYISETI Germaine", contact_position: "Financial Assistant", contact_phone_number: "0788441327", contact_main_office_phone_number: "", contact_office_location: "KICUKIRO">
>> d.organization_id_responder = 3954
d.save!
=> 3954
>> d.save!
=> true
>> Activity.find_by_sql(' SELECT id FROM activities WHERE data_response_id IN ( SELECT id from data_responses WHERE id NOT IN ( SELECT data_responses.id FROM data_responses INNER JOIN organizations ON data_responses.organization_id_responder = organizations.id ) ) ')
=> []
>> FundingFlow.find_by_sql(' SELECT id FROM funding_flows WHERE data_response_id IN ( SELECT id from data_responses WHERE id NOT IN ( SELECT data_responses.id FROM data_responses INNER JOIN organizations ON data_responses.organization_id_responder = organizations.id ) ) ')
=> []
>> Project.find_by_sql(' SELECT id FROM projects WHERE data_response_id IN ( SELECT id from data_responses WHERE id NOT IN ( SELECT data_responses.id FROM data_responses INNER JOIN organizations ON data_responses.organization_id_responder = organizations.id ) ) ')
=> []



